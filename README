use RecursiveSSH;

my $rssh = RecursiveSSH->new({
  children => $sub_to_find_more_machines,
});

$rssh->connect;

$rssh->exec(
  $sub_to_run_remotely,
  $on_read_cb,
  $on_done_cb,
);

$rssh->exec(...); # this follows the first

$rssh->loop; # consume all output from the last two execs

$rssh->exec(...);

$rssh->loop; # consume all output from the last exec

$rssh->quit;



-----------------------------------------------------------

Take a look at find_person.pl for an example script
